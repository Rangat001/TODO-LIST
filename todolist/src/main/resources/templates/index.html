<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <title>Todo List</title>-->
<!--    <link rel="stylesheet" href="/css/style.css">-->
<!--</head>-->
<!--<body>-->
<!--<div class="container">-->
<!--    <header>-->
<!--        <h1>My Todo List</h1>-->
<!--        <div class="user-info">-->
<!--            <span th:text="${user.fullName}"></span>-->
<!--            <a th:href="@{/logout}">Logout</a>-->
<!--        </div>-->
<!--    </header>-->

<!--    <div class="todo-form">-->
<!--        <form th:action="@{/todos}" method="post">-->
<!--            <input type="text" name="title" placeholder="What needs to be done?" required>-->
<!--            <input type="text" name="description" placeholder="Description (optional)">-->
<!--            <input type="datetime-local" name="dueDate">-->
<!--            <button type="submit">Add Todo</button>-->
<!--        </form>-->
<!--    </div>-->

<!--    <div class="todo-list">-->
<!--        <div th:each="todo : ${todos}" class="todo-item">-->
<!--            <input type="checkbox" th:checked="${todo.completed}"-->
<!--                   th:onchange="'updateTodoStatus(' + ${todo.id} + ', this.checked)'">-->
<!--            <span th:text="${todo.title}" th:class="${todo.completed ? 'completed' : ''}"></span>-->
<!--            <span class="due-date" th:if="${todo.dueDate}"-->
<!--                  th:text="${#temporals.format(todo.dueDate, 'yyyy-MM-dd HH:mm')}"></span>-->
<!--            <button th:onclick="'deleteTodo(' + ${todo.id} + ')'">Delete</button>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!--<script src="/js/todo.js"></script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dashboard</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="container">
    <h1>Dashboard</h1>
    <h2 id="welcomeText">Welcome!</h2>

</div>

<script>
    window.onload = async function () {
        const token = localStorage.getItem('jwt_token');
//
//        // If no token found, redirect to login
//        if (!token) {
//            window.location.href = '/public/login';
//            return;
//        }

        try {
            const response = await fetch('/public/validate', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Accept': 'application/json'
                }
            });

            if (!response.ok) {
                // Token is invalid or expired
//                localStorage.removeItem('jwt_token');
//                window.location.href = '/public/login';
            } else {
                const data = await response.json();
                console.log('Token is valid. User data:', data);

                // Display user full name
                const welcomeText = document.getElementById('welcomeText');
                if (welcomeText && data.fullName) {
                    welcomeText.textContent = `Welcome, ${data.fullName}!`;
                }
            }

        } catch (error) {
            console.error('Validation failed:', error);
//            localStorage.removeItem('jwt_token');
//            window.location.href = '/public/login';
        }
    };
</script>

</body>
</html>